import{j as t,P as a,B as at,K as rt,T as u,H as it,r as l,m as T,M as W,N as ot,W as ct}from"./index-8da285d5.js";import{a as k}from"./format-time-56b99ef4.js";import{S as lt}from"./spinner-e32551ae.js";import{L as dt}from"./label-b733c5bf.js";import{T as q,a as x,b as ut,G as s,c as ht,d as xt,e as mt,s as pt,m as jt,C as ft,h as B,t as E,g as gt}from"./css-3eba7ff6.js";import{T as Ct,v as yt,a as bt,b as Tt,e as vt,c as wt,d as St,s as I,g as Nt}from"./table-empty-rows-08b9ede3.js";import{B as D}from"./Button-d5458c65.js";import{O as Pt,I as It,T as O}from"./InputAdornment-1876e57d.js";import{C as Dt}from"./Container-b0b1d604.js";import{C as v}from"./Card-0f72929b.js";import{T as w}from"./TextField-e9b80faf.js";import"./MenuItem-987a08fa.js";import"./Menu-beda51cc.js";import"./isMuiElement-8abfc897.js";function A({unityContractNo:r,title:o,changes:d,contractTermsContent:m,writeDt:h,useTf:j,basicContractTf:n,onClick:f}){return t.jsxs(q,{hover:!0,tabIndex:-1,onClick:f,children:[t.jsx(x,{component:"th",style:{fontWeight:"bold"},align:"center",children:r}),t.jsx(x,{children:o}),t.jsx(x,{children:d}),t.jsx(x,{children:k(h,"yy/MM/dd hh:mm")}),t.jsxs(x,{align:"center",children:[j,"개"]}),t.jsx(x,{align:"center",children:t.jsx(dt,{color:{Y:"success",N:"warning"}[n],children:n})})]})}A.propTypes={unityContractNo:a.any,title:a.any,changes:a.any,contractTermsContent:a.any,writeDt:a.any,useTf:a.any,basicContractTf:a.any,onClick:a.func};function L({order:r,orderBy:o,rowCount:d,headLabel:m,onRequestSort:h}){const j=n=>f=>{h(f,n)};return t.jsx(ut,{children:t.jsx(q,{children:m.map(n=>t.jsx(x,{align:n.align||"left",sortDirection:o===n.id?r:!1,sx:{width:n.width,minWidth:n.minWidth},children:t.jsxs(Ct,{hideSortIcon:!0,active:o===n.id,direction:o===n.id?r:"asc",onClick:j(n.id),children:[n.label,o===n.id?t.jsx(at,{sx:{...yt},children:r==="desc"?"sorted descending":"sorted ascending"}):null]})},n.id))})})}L.propTypes={order:a.oneOf(["asc","desc"]),orderBy:a.string,rowCount:a.number,headLabel:a.array,onRequestSort:a.func};function M({filterName:r,onFilterName:o,onNewContract:d}){return t.jsxs(rt,{sx:{height:96,display:"flex",justifyContent:"space-between"},children:[t.jsxs(s,{container:!0,spacing:2,children:[t.jsx(s,{item:!0,children:t.jsx(u,{variant:"h4",children:"통일 계약서 관리"})}),t.jsx(s,{item:!0,children:t.jsx(D,{variant:"contained",size:"small",onClick:d,sx:{marginTop:"5px"},children:"새 계약서 등록"})})]}),t.jsx(Pt,{value:r,onChange:o,placeholder:"제목으로 검색",startAdornment:t.jsx(It,{position:"start",children:t.jsx(it,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})})]})}M.propTypes={filterName:a.string,onFilterName:a.func,onNewContract:a.func};function Rt(){const[r,o]=l.useState([]),[d,m]=l.useState(0),[h,j]=l.useState("asc"),[n,f]=l.useState("name"),[C,H]=l.useState(""),[g,Y]=l.useState(5),[$,S]=l.useState(!1),[p,N]=l.useState(!1),[i,y]=l.useState({}),[z,G]=l.useState(!0);l.useEffect(()=>{},[i]),l.useEffect(()=>{U()},[]);const U=async()=>{await T.get("/adm/unityContractsInfo").then(e=>{o([...e.data].map((c,b)=>({no:e.data.length-b,...c}))),G(!1)}).catch(()=>{})},K=(e,c)=>{c!==""&&(j(n===c&&h==="asc"?"desc":"asc"),f(c))},V=async e=>{S(!0);const c=await T.get(`/adm/unityContractInfo/${e}`);y(c.data)},R=()=>{S(!1),N(!1)},Z=()=>{N(!0)},P=e=>{const{id:c,value:b}=e.target;p&&y({...i,[c]:b})},J=()=>{S(!0),N(!0),y({})},Q=async()=>{const e=await T.post("/adm/postUnityContract",i);console.log(e.data),o([e.data,...r]),I("success","계약서 등록 성공")},X=async()=>{(await T.get(`/adm/putUnityBasic/${i.unityContractNo}`)).data>0?(I("success","기본 계약서 변경 완료"),o(_()),y({...i,basicContractTf:"Y"})):I("error","기본 계약서 변경 실패")},_=()=>r.map(e=>e.unityContractNo===i.unityContractNo?{...e,basicContractTf:"Y"}:{...e,basicContractTf:"N"}),tt=(e,c)=>{m(c)},et=e=>{m(0),Y(parseInt(e.target.value,10))},nt=e=>{m(0),H(e.target.value)},F=bt({inputData:r,comparator:Nt(h,n),filterName:C,filters:["unityContractNo","title","changes","basicContractTf"]}),st=!F.length&&!!C;return z?t.jsx(lt,{}):t.jsxs(t.Fragment,{children:[t.jsx(Dt,{children:t.jsxs(v,{children:[t.jsx(M,{filterName:C,onFilterName:nt,onNewContract:J}),t.jsx(W,{children:t.jsx(ht,{sx:{overflow:"unset"},children:t.jsxs(xt,{sx:{minWidth:800},children:[t.jsx(L,{order:h,orderBy:n,rowCount:r.length,onRequestSort:K,headLabel:[{id:"unityContractNo",label:"번호",align:"center"},{id:"title",label:"제목"},{id:"changes",label:"변경사항"},{id:"writeDt",label:"작성일"},{id:"useTf",label:"사용여부",align:"center"},{id:"basicContractTf",label:"기본 계약서 여부",align:"center"}]}),t.jsxs(mt,{children:[F.slice(d*g,d*g+g).map((e,c)=>t.jsx(A,{unityContractNo:e.no,title:e.title,changes:e.changes,contractTermsContent:e.contractTermsContent,writeDt:e.writeDt,useTf:e.useTf,basicContractTf:e.basicContractTf,onClick:()=>V(e.unityContractNo)},e.unityContractNo)),t.jsx(Tt,{height:77,emptyRows:vt(d,g,r.length)}),st&&t.jsx(wt,{query:C,colSpan:6})]})]})})}),t.jsx(St,{page:d,component:"div",count:r.length,rowsPerPage:g,onPageChange:tt,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:et})]})}),t.jsx(ot,{open:$,onClose:R,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:t.jsxs(v,{sx:{...pt},children:[t.jsxs(s,{sx:jt,children:[t.jsx(u,{variant:"h6",component:"h2",children:"통일 계약서 정보"}),!p&&i.basicContractTf==="N"&&t.jsx(D,{variant:"contained",color:"primary",onClick:X,children:"기본 계약서로 지정"})]}),t.jsx(W,{sx:{height:"90%"},children:t.jsx(ft,{children:t.jsxs(s,{container:!0,spacing:2,children:[t.jsx(s,{item:!0,xs:12,children:t.jsxs(v,{sx:B,children:[t.jsxs(s,{container:!0,spacing:2,children:[t.jsxs(s,{item:!0,xs:12,children:[t.jsx(u,{variant:"subtitle1",children:"제목"}),t.jsx(w,{variant:"outlined",id:"title",value:i.title||"",onChange:P,fullWidth:!0,required:!0})]}),t.jsxs(s,{item:!0,xs:12,children:[t.jsx(u,{variant:"subtitle1",children:"내용"}),t.jsx(O,{id:"contractTermsContent",style:{...E,overflow:"hidden"},value:i.contractTermsContent||"",onChange:P,required:!0})]})]}),t.jsxs(s,{item:!0,xs:12,children:[t.jsx(u,{variant:"subtitle1",children:"변경사항"}),t.jsx(O,{id:"changes",style:{...E,overflow:"hidden"},value:i.changes||"",onChange:P,required:!0})]})]})}),!p&&t.jsx(s,{item:!0,xs:12,children:t.jsx(v,{sx:B,children:t.jsxs(s,{container:!0,spacing:2,children:[t.jsxs(s,{item:!0,xs:12,children:[t.jsx(u,{variant:"subtitle1",children:"작성일"}),t.jsx(w,{variant:"outlined",value:k(i.writeDt,"yyyy/MM/dd hh:mm"),fullWidth:!0})]}),t.jsxs(s,{item:!0,container:!0,spacing:2,xs:12,children:[t.jsxs(s,{item:!0,xs:6,children:[t.jsx(u,{variant:"subtitle1",children:"기본 계약서 여부"}),t.jsx(w,{variant:"outlined",value:i.basicContractTf||"",fullWidth:!0})]}),t.jsxs(s,{item:!0,xs:6,children:[t.jsx(u,{variant:"subtitle1",children:"사용 여부"}),t.jsx(w,{variant:"outlined",value:i.useTf||"",fullWidth:!0})]})]})]})})})]})})}),t.jsx(D,{variant:"contained",fullWidth:!0,color:p?"success":"primary",sx:{...gt,display:i.contractsState==="회원 탈퇴"?"none":""},onClick:async()=>{p?(Q(),R()):Z()},children:p?"새 계약서로 저장하기":"다시 쓰기"})]})})]})}function Gt(){return t.jsxs(t.Fragment,{children:[t.jsx(ct,{children:t.jsx("title",{children:" 통일 계약서 관리 | EZT "})}),t.jsx(Rt,{})]})}export{Gt as default};
