import{j as e,P as i,B as le,K as de,T as o,H as xe,r as a,O as he,m as T,M as S,N as E,W as ue}from"./index-c6ed9b6e.js";import{a as I}from"./format-time-56b99ef4.js";import{S as me}from"./spinner-203ae6f7.js";import{L as fe}from"./label-819a5638.js";import{T as H,a as f,b as je,c as pe,d as ye,e as ge,s as k,G as n,m as be,C as L,h as Te,f as g,g as Ce,i as ve,t as Ae}from"./css-c871e19b.js";import{T as Ne,v as Se,a as we,b as Ie,e as De,c as Pe,d as Re,s as C,g as Oe}from"./table-empty-rows-b07c24c5.js";import{O as Fe,I as Me,T as Be}from"./InputAdornment-0edd63ac.js";import{C as We}from"./Container-b62d1592.js";import{C as v}from"./Card-529b481d.js";import{B as w}from"./Button-64e18b36.js";import"./MenuItem-c2658677.js";import"./Menu-20639312.js";function q({careerNo:t,usersName:l,careerInfo:x,careerAccessTf:h,careerAccessTfNm:u,writeDt:j,onClick:r}){const p={maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"};return e.jsxs(H,{hover:!0,tabIndex:-1,onClick:r,children:[e.jsx(f,{component:"th",style:{fontWeight:"bold"},align:"center",children:t}),e.jsx(f,{children:l}),e.jsx(f,{sx:p,children:x}),e.jsx(f,{align:"center",children:e.jsx(fe,{color:{A01:"warning",A02:"success",A03:"error"}[h],children:u})}),e.jsx(f,{children:I(j,"yy/MM/dd hh:mm")})]})}q.propTypes={careerNo:i.any,usersName:i.any,careerInfo:i.any,careerAccessTf:i.any,careerAccessTfNm:i.any,writeDt:i.any,onClick:i.func};function $({order:t,orderBy:l,rowCount:x,headLabel:h,onRequestSort:u}){const j=r=>p=>{u(p,r)};return e.jsx(je,{children:e.jsx(H,{children:h.map(r=>e.jsx(f,{align:r.align||"left",sortDirection:l===r.id?t:!1,sx:{width:r.width,minWidth:r.minWidth},children:e.jsxs(Ne,{hideSortIcon:!0,active:l===r.id,direction:l===r.id?t:"asc",onClick:j(r.id),children:[r.label,l===r.id?e.jsx(le,{sx:{...Se},children:t==="desc"?"sorted descending":"sorted ascending"}):null]})},r.id))})})}$.propTypes={order:i.oneOf(["asc","desc"]),orderBy:i.string,rowCount:i.number,headLabel:i.array,onRequestSort:i.func};function G({filterName:t,onFilterName:l}){return e.jsxs(de,{sx:{height:96,display:"flex",justifyContent:"space-between"},children:[e.jsx(o,{variant:"h4",children:"경력 인증 관리"}),e.jsx(Fe,{value:t,onChange:l,placeholder:"이름으로 검색",startAdornment:e.jsx(Me,{position:"start",children:e.jsx(xe,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})})]})}G.propTypes={filterName:i.string,onFilterName:i.func};function Ee(){const[t,l]=a.useState([]),[x,h]=a.useState(0),[u,j]=a.useState("asc"),[r,p]=a.useState("name"),[b,z]=a.useState(""),[y,K]=a.useState(5),[V,D]=a.useState(!1),[Z,P]=a.useState(!1),[d,A]=a.useState({}),[R,N]=a.useState(""),[J,Q]=a.useState(!0),U=a.useContext(he);a.useEffect(()=>{},[d]),a.useEffect(()=>{console.log("second",t)},[t]),a.useEffect(()=>{X()},[]);const X=async()=>{await T.get("/adm/careersInfo").then(s=>{console.log("first",s.data),l([...s.data].map((c,m)=>({no:s.data.length-m,...c}))),Q(!1)}).catch(()=>{})},Y=(s,c)=>{c!==""&&(j(r===c&&u==="asc"?"desc":"asc"),p(c))},_=async s=>{const c=await T.get(`/adm/careerInfo/${s}`);A(c.data),D(!0)},ee=()=>{D(!1)},se=()=>{P(!0),N("")},O=()=>{P(!1),N("")},re=s=>{const{value:c}=s.target;N(c)},te=async()=>{(await T.get(`/adm/careerAccept/${d.careerNo}`)).data===1?(l(F("A02","승인")),A({...d,careerAccessTf:"A02",careerAccessTfNm:"승인"}),C("success","승인 처리 되었습니다.")):C("error","승인 처리에 실패했습니다.")},ae=async()=>{const s={content:R,writer:U.usersNo,careerNo:d.careerNo};(await T.post("/adm/careerDeny",s)).data===1?(l(F("A03","반려")),A({...d,careerAccessTf:"A03",careerAccessTfNm:"반려"}),C("success","반려 처리 되었습니다."),O()):C("error","반려 처리에 실패했습니다.")},F=(s,c)=>t.map(m=>m.careerNo===d.careerNo?{...m,careerAccessTf:s,careerAccessTfNm:c}:m),ne=(s,c)=>{h(c)},ce=s=>{h(0),K(parseInt(s.target.value,10))},ie=s=>{h(0),z(s.target.value)},M=we({inputData:t,comparator:Oe(u,r),filterName:b,filters:["careerNo","usersName","careerInfo","careerAccessTfNm"]}),oe=!M.length&&!!b;function B(){return e.jsx(n,{item:!0,xs:!0,children:e.jsx(w,{variant:"contained",fullWidth:!0,color:"error",onClick:se,children:"반려하기"})})}function W(){return e.jsx(n,{item:!0,xs:!0,children:e.jsx(w,{variant:"contained",fullWidth:!0,color:"success",onClick:te,children:"승인하기"})})}return J?e.jsx(me,{}):e.jsxs(e.Fragment,{children:[e.jsx(We,{children:e.jsxs(v,{children:[e.jsx(G,{filterName:b,onFilterName:ie}),e.jsx(S,{children:e.jsx(pe,{sx:{overflow:"unset"},children:e.jsxs(ye,{sx:{minWidth:800},children:[e.jsx($,{order:u,orderBy:r,rowCount:t.length,onRequestSort:Y,headLabel:[{id:"careerNo",label:"요청번호",align:"center"},{id:"usersName",label:"요청인"},{id:"careerInfo",label:"경력 내용"},{id:"careerAccessTf",label:"요청상태",align:"center"},{id:"writeDt",label:"요청일"}]}),e.jsxs(ge,{children:[M.slice(x*y,x*y+y).map(s=>e.jsx(q,{careerNo:s.no,usersName:s.usersName,careerInfo:s.careerInfo,careerAccessTf:s.careerAccessTf,careerAccessTfNm:s.careerAccessTfNm,writeDt:s.writeDt,onClick:()=>_(s.careerNo)},s.careerNo)),e.jsx(Ie,{height:77,emptyRows:De(x,y,t.length)}),oe&&e.jsx(Pe,{query:b,colSpan:5})]})]})})}),e.jsx(Re,{page:x,component:"div",count:t.length,rowsPerPage:y,onPageChange:ne,rowsPerPageOptions:[5,10,25],onRowsPerPageChange:ce})]})}),e.jsx(E,{open:V,onClose:ee,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs(v,{sx:k,children:[e.jsx(n,{sx:be,children:e.jsx(o,{variant:"h6",component:"h2",children:"경력 인증 요청 정보"})}),e.jsx(S,{sx:{height:"90%"},children:e.jsx(L,{children:e.jsx(n,{container:!0,spacing:2,children:e.jsx(n,{item:!0,xs:12,children:e.jsx(v,{sx:Te,children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsxs(n,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle1",children:"이름"}),e.jsx(o,{style:g,variant:"body1",children:d.usersName})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle1",children:"경력 내용"}),e.jsx(o,{style:g,variant:"body1",children:d.careerInfo})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle1",children:"경력 기간"}),e.jsxs(n,{item:!0,container:!0,children:[e.jsx(n,{item:!0,xs:5,children:e.jsx(o,{style:g,variant:"body1",children:I(d.careerStartDt,"yyyy/MM/dd")})}),e.jsx(n,{item:!0,xs:2,children:e.jsx(o,{lineHeight:3,align:"center",children:"~"})}),e.jsx(n,{item:!0,xs:5,children:e.jsx(o,{style:g,variant:"body1",children:I(d.careerEndDt,"yyyy/MM/dd")})})]})]}),e.jsxs(n,{item:!0,xs:12,children:[e.jsx(o,{variant:"subtitle1",children:"첨부 파일"}),e.jsx(o,{style:g,variant:"body1",children:d.fileId})]})]})})})})})}),e.jsx(n,{container:!0,spacing:2,sx:Ce,children:{A01:e.jsxs(e.Fragment,{children:[e.jsx(W,{}),e.jsx(B,{})]}),A02:e.jsx(B,{}),A03:e.jsx(W,{})}[d.careerAccessTf]})]})}),e.jsx(E,{open:Z,onClose:O,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",id:"myModal",children:e.jsxs(v,{sx:{...k,...ve,height:"45%"},children:[e.jsx(o,{variant:"h6",component:"h2",children:"반려사유 작성"}),e.jsx(S,{sx:{height:"85%"},children:e.jsx(L,{children:e.jsx(Be,{id:"denyReason",style:{...Ae,overflow:"hidden"},value:R,onChange:re,required:!0})})}),e.jsx(w,{variant:"contained",fullWidth:!0,sx:{position:"relative",top:-60},color:"error",onClick:ae,children:"반려확정"})]})})]})}function Ue(){return e.jsxs(e.Fragment,{children:[e.jsx(ue,{children:e.jsx("title",{children:" 경력 인증 관리 | EZT "})}),e.jsx(Ee,{})]})}export{Ue as default};
